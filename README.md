# Документация для запуска сервера:
## Общая часть
* Копируем все файлы для билда через `git clone`
* Редактируем `docker-compose.yml`, выставляя необходимые данные (USER_ID, GROUP_ID, ENV, место маунта файлов, и т.д.)
** Здесь так же можно задать логин и пароль для администраторского аккаунта (FTP_USER и FTP_PASS).
** Внимание: Админский аккаунт НЕ будет работать (если быть точнее, не будет создан), если существует файл примонтированный users.txt.
** Если не указать FTP_PASS, будет сгенерирован случайный на 16 символов (меняется каждый раз при перезапуске контейнера)
* Так же стоит обратить внимание на переменную FTP_OWN. Если она будет установлена в YES, то примонтированная секция будет рекурсивно передаваться под контроль ftp-сервера, и это может быть не лучшим решением если овнер этой секции важен.
* В секцию volumes добавляем <монтируемая секция>:/mnt

## Часть "временный / постоянный сервер для 1 пользователя-админа"
* стираем файл users.txt из секции volumes (если есть) и директорию /user_chroots (если есть)
* При запуске будет сгенерирован логин и пароль (либо использованы из FTP_USER / FTP_PASS), и этому пользователю будет доступна вся папка /mnt (все примонтированные файлы, администраторский доступ)

## Часть "сервер для множественных пользователей"
* В файле users.txt создаем пользователей типа username \n password. По две строки на каждого пользователя. Количество не ограничено.
* Создаем папку /user_chroots, в ней папки с именами пользователей (например ./user_chroots/username1)
* Через команду `ln -sf /mnt/... ./user_chroots/username1/название_ресурса` даем доступ к тому или иному участку сервера.


# Лайв пример:
Нужно сделать 3 отдельных пользователя, каждый со своим доступом к отдельному сайту в папке /var/www

*Секция volumes композера выглядит так:*
```
    volumes:
      - /var/www:/mnt
      - ./user_chroots:/home
      - ./users.txt:/etc/vsftpd/virtual_users.txt
```

*./users.txt выглядит так:*
```
userwebsite1
passwordwebsite1
userwebsite2
passwordwebsite2
userwebsite3
passwordwebsite3
```

*Папка ./user_chroots имеет следующие выполненные команды*
```
mkdir ./user_chroots/userwebsite1
ln -sf /mnt/website1.com ./user_chroots/userwebsite1/www

mkdir ./user_chroots/userwebsite2
ln -sf /mnt/website2.ru ./user_chroots/userwebsite2/www

mkdir ./user_chroots/userwebsite3
ln -sf /mnt/website3.co.uk ./user_chroots/userwebsite3/www
```